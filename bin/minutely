#!/bin/bash

cd /var/www/liteapi
exec >> log/minutely.log 2>&1

bin/lite getinfo > etc/lite.info 2>&1

# this could be moved to the "onblock" callback from the dameon... but whatever for now

# simple status file shows current success codes for all minutely jobs 
echo "{" > etc/lite.status
echo dt:`date +%s` >> etc/lite.status
bin/forward && echo fw >> etc/lite.status             # forward transactions, add to db
bin/callback && echo cb >> etc/lite.status            # hit some urls
bin/loadlog && echo ll >> etc/lite.status             # in case db was down, load from log
bin/repair && echo rp >> etc/lite.status              # in case log didn't work, use the blockchain
echo "}" >> etc/lite.status
